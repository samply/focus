# Focus

Focus is a Samply component ran on the sites, which distributes tasks from Beam.Proxy to the applications on the site and re-transmits the results through Samply.Beam. Currenly, only Samply.Blaze is supported as a target application, but Focus is easily extensible.

## Installation

### Samply/Bridgehead Integration

Focus is already included in the [Samply.Bridgehead deployment](https://github.com/samply/bridgehead/), a turnkey solution for deploying, maintaining, and monitoring applications in a medical IT environment.

### Standalone Installation

To run a standalone Focus, you need at least one running [Samply.Beam.Proxy](https://github.com/samply/beam/) and one running [Samply.Blaze FHIR store](https://github.com/samply/blaze).
You can compile and run this application via Cargo, however, we encourage the usage of the pre-compiled [docker images](https://hub.docker.com/r/samply/focus):

```bash
docker run --rm -e BEAM_BASE_URL=http://localhost:8081 -e BLAZE_BASE_URL=http://localhost:8089/fhir -e PROXY_ID=proxy1.broker -e API_KEY=App1Secret -e BEAM_APP_ID_LONG=app1.broker.example.com samply/focus:latest
```

## Configuration

The following environment variables are mandatory for the usage of Focus. If compiling and running Focus yourself, they are provided as command line options as well. See `focus  --help` for details.

```bash
BEAM_BASE_URL = "http://localhost:8081"
BLAZE_BASE_URL = "http://localhost:8089/fhir"
PROXY_ID = "proxy1.broker"
API_KEY = "App1Secret"
BEAM_APP_ID_LONG = "app1.broker.example.com"
```

### Optional variables

```bash
RETRY_COUNT = "32"
```

The default maximum number of retries for beam and blaze healthchecks is 32. 

To disable the count obfuscation, set the env. variable `DO_NOT_OBFUSCATE`.

Optionally, you can provide the `TLS_CA_CERTIFICATES_DIR` environment variable to add additional trusted certificates, e.g., if you have a TLS-terminating proxy server in place. The application respects the `HTTP_PROXY`, `HTTPS_PROXY`, `ALL_PROXY`, `NO_PROXY`, and their respective lowercase equivalents.

## Usage

Creating a sample task using CURL:

```bash
curl -v -X POST -H "Content-Type: application/json" --data '{"id":"7fffffff-ffff-ffff-ffff-ffffffffffff","from":"app1.proxy1.broker","to":["app1.proxy1.broker"],"ttl":"10s","failure_strategy":{"retry":{"backoff_millisecs":1000,"max_tries":5}},"metadata":"The broker can read and use this field e.g., to apply filters on behalf of an app","body":"ewoJImxhbmciOiAiY3FsIiwKCSJsaWIiOiB7CgkJImNvbnRlbnQiOiBbCgkJCXsKCQkJCSJjb250ZW50VHlwZSI6ICJ0ZXh0L2NxbCIsCgkJCQkiZGF0YSI6ICJiR2xpY21GeWVTQlNaWFJ5YVdWMlpRcDFjMmx1WnlCR1NFbFNJSFpsY25OcGIyNGdKelF1TUM0d0p3cHBibU5zZFdSbElFWklTVkpJWld4d1pYSnpJSFpsY25OcGIyNGdKelF1TUM0d0p3b0tZMjlrWlhONWMzUmxiU0JzYjJsdVl6b2dKMmgwZEhBNkx5OXNiMmx1WXk1dmNtY25DbU52WkdWemVYTjBaVzBnYVdOa01UQTZJQ2RvZEhSd09pOHZhR3czTG05eVp5OW1hR2x5TDNOcFpDOXBZMlF0TVRBbkNtTnZaR1Z6ZVhOMFpXMGdVMkZ0Y0d4bFRXRjBaWEpwWVd4VWVYQmxPaUFuYUhSMGNITTZMeTltYUdseUxtSmliWEpwTG1SbEwwTnZaR1ZUZVhOMFpXMHZVMkZ0Y0d4bFRXRjBaWEpwWVd4VWVYQmxKd29LWTI5a1pYTjVjM1JsYlNCcFkyUXhNR2R0T2lBbmFIUjBjRG92TDJab2FYSXVaR1V2UTI5a1pWTjVjM1JsYlM5a2FXMWthUzlwWTJRdE1UQXRaMjBuQ2dwamIyNTBaWGgwSUZCaGRHbGxiblFLQ2tKQ1RWSkpYMU5VVWtGVVgwZEZUa1JGVWw5VFZGSkJWRWxHU1VWU0NncENRazFTU1Y5VFZGSkJWRjlFUlVaZlUxQkZRMGxOUlU0S2FXWWdTVzVKYm1sMGFXRnNVRzl3ZFd4aGRHbHZiaUIwYUdWdUlGdFRjR1ZqYVcxbGJsMGdVeUIzYUdWeVpTQW9LQ2hUTG5SNWNHVXVZMjlrYVc1bkxtTnZaR1VnWTI5dWRHRnBibk1nSjJKc2IyOWtMWE5sY25WdEp5a3BJRzl5Q2lnb1V5NTBlWEJsTG1OdlpHbHVaeTVqYjJSbElHTnZiblJoYVc1eklDZDBhWE56ZFdVdFpuSnZlbVZ1SnlrcElHOXlDaWdvVXk1MGVYQmxMbU52WkdsdVp5NWpiMlJsSUdOdmJuUmhhVzV6SUNkM2FHOXNaUzFpYkc5dlpDY3BLU0J2Y2dvb0tGTXVkSGx3WlM1amIyUnBibWN1WTI5a1pTQmpiMjUwWVdsdWN5QW5ZbXh2YjJRdGNHeGhjMjFoSnlrcElHOXlDaWdvVXk1MGVYQmxMbU52WkdsdVp5NWpiMlJsSUdOdmJuUmhhVzV6SUNkMGFYTnpkV1V0YjNSb1pYSW5LU2tnYjNJS0tDaFRMblI1Y0dVdVkyOWthVzVuTG1OdlpHVWdZMjl1ZEdGcGJuTWdKM0JsY21sd2FHVnlZV3d0WW14dmIyUXRZMlZzYkhNdGRtbDBZV3duS1NrZ2IzSUtLQ2hUTG5SNWNHVXVZMjlrYVc1bkxtTnZaR1VnWTI5dWRHRnBibk1nSjNKdVlTY3BLU0J2Y2dvb0tGTXVkSGx3WlM1amIyUnBibWN1WTI5a1pTQmpiMjUwWVdsdWN5QW5kWEpwYm1VbktTa2diM0lLS0NoVExuUjVjR1V1WTI5a2FXNW5MbU52WkdVZ1kyOXVkR0ZwYm5NZ0oyeHBjWFZwWkMxdmRHaGxjaWNwS1NCdmNnb29LRk11ZEhsd1pTNWpiMlJwYm1jdVkyOWtaU0JqYjI1MFlXbHVjeUFuWW5WbVpua3RZMjloZENjcEtTQnZjZ29vS0ZNdWRIbHdaUzVqYjJScGJtY3VZMjlrWlNCamIyNTBZV2x1Y3lBblpHNWhKeWtwSUc5eUNpZ29VeTUwZVhCbExtTnZaR2x1Wnk1amIyUmxJR052Ym5SaGFXNXpJQ2RpYjI1bExXMWhjbkp2ZHljcEtTQnZjZ29vS0ZNdWRIbHdaUzVqYjJScGJtY3VZMjlrWlNCamIyNTBZV2x1Y3lBbmRHbHpjM1ZsTFdabWNHVW5LU2tnYjNJS0tDaFRMblI1Y0dVdVkyOWthVzVuTG1OdlpHVWdZMjl1ZEdGcGJuTWdKM05oYkdsMllTY3BLU0J2Y2dvb0tGTXVkSGx3WlM1amIyUnBibWN1WTI5a1pTQmpiMjUwWVdsdWN5QW5aSEpwWldRdGQyaHZiR1V0WW14dmIyUW5LU2tnYjNJS0tDaFRMblI1Y0dVdVkyOWthVzVuTG1OdlpHVWdZMjl1ZEdGcGJuTWdKM0JzWVhOdFlTMWxaSFJoSnlrcElHOXlDaWdvVXk1MGVYQmxMbU52WkdsdVp5NWpiMlJsSUdOdmJuUmhhVzV6SUNkd2JHRnpiV0V0WTJsMGNtRjBKeWtwSUc5eUNpZ29VeTUwZVhCbExtTnZaR2x1Wnk1amIyUmxJR052Ym5SaGFXNXpJQ2R3YkdGemJXRXRhR1Z3WVhKcGJpY3BLU0J2Y2dvb0tGTXVkSGx3WlM1amIyUnBibWN1WTI5a1pTQmpiMjUwWVdsdWN5QW5jR3hoYzIxaExXTmxiR3d0Wm5KbFpTY3BLU0J2Y2dvb0tGTXVkSGx3WlM1amIyUnBibWN1WTI5a1pTQmpiMjUwWVdsdWN5QW5jR3hoYzIxaExXOTBhR1Z5SnlrcElHOXlDaWdvVXk1MGVYQmxMbU52WkdsdVp5NWpiMlJsSUdOdmJuUmhhVzV6SUNkd2JHRnpiV0VuS1NrZ2IzSUtLQ2hUTG5SNWNHVXVZMjlrYVc1bkxtTnZaR1VnWTI5dWRHRnBibk1nSjNObGNuVnRKeWtwSUc5eUNpZ29VeTUwZVhCbExtTnZaR2x1Wnk1amIyUmxJR052Ym5SaGFXNXpJQ2QwZFcxdmNpMTBhWE56ZFdVdFptWndaU2NwS1NCdmNnb29LRk11ZEhsd1pTNWpiMlJwYm1jdVkyOWtaU0JqYjI1MFlXbHVjeUFuYm05eWJXRnNMWFJwYzNOMVpTMW1abkJsSnlrcElHOXlDaWdvVXk1MGVYQmxMbU52WkdsdVp5NWpiMlJsSUdOdmJuUmhhVzV6SUNkdmRHaGxjaTEwYVhOemRXVXRabVp3WlNjcEtTQnZjZ29vS0ZNdWRIbHdaUzVqYjJScGJtY3VZMjlrWlNCamIyNTBZV2x1Y3lBbmRHbHpjM1ZsTFdadmNtMWhiR2x1SnlrcElHOXlDaWdvVXk1MGVYQmxMbU52WkdsdVp5NWpiMlJsSUdOdmJuUmhhVzV6SUNkMGRXMXZjaTEwYVhOemRXVXRabkp2ZW1WdUp5a3BJRzl5Q2lnb1V5NTBlWEJsTG1OdlpHbHVaeTVqYjJSbElHTnZiblJoYVc1eklDZHViM0p0WVd3dGRHbHpjM1ZsTFdaeWIzcGxiaWNwS1NCdmNnb29LRk11ZEhsd1pTNWpiMlJwYm1jdVkyOWtaU0JqYjI1MFlXbHVjeUFuYjNSb1pYSXRkR2x6YzNWbExXWnliM3BsYmljcEtTQnZjZ29vS0ZNdWRIbHdaUzVqYjJScGJtY3VZMjlrWlNCamIyNTBZV2x1Y3lBblkyWXRaRzVoSnlrcElHOXlDaWdvVXk1MGVYQmxMbU52WkdsdVp5NWpiMlJsSUdOdmJuUmhhVzV6SUNkbkxXUnVZU2NwS1NCdmNnb29LRk11ZEhsd1pTNWpiMlJwYm1jdVkyOWtaU0JqYjI1MFlXbHVjeUFuZEdsemMzVmxMWEJoZUdkbGJtVXRiM0l0Wld4elpTY3BLU0J2Y2dvb0tGTXVkSGx3WlM1amIyUnBibWN1WTI5a1pTQmpiMjUwWVdsdWN5QW5kR2x6YzNWbEp5a3BJRzl5Q2lnb1V5NTBlWEJsTG1OdlpHbHVaeTVqYjJSbElHTnZiblJoYVc1eklDZHNhWEYxYVdRbktTa3BJR1ZzYzJVZ2UzMGdZWE1nVEdsemREeFRjR1ZqYVcxbGJqNEtDa0pDVFZKSlgxTlVVa0ZVWDFOQlRWQk1SVjlVV1ZCRlgxTlVVa0ZVU1VaSlJWSUtDa0pDVFZKSlgxTlVVa0ZVWDBOVlUxUlBSRWxCVGw5VFZGSkJWRWxHU1VWU0NncENRazFTU1Y5VFZGSkJWRjlFU1VGSFRrOVRTVk5mVTFSU1FWUkpSa2xGVWdvS1FrSk5Va2xmVTFSU1FWUmZRVWRGWDFOVVVrRlVTVVpKUlZJS0NrSkNUVkpKWDFOVVVrRlVYMFJGUmw5SlRsOUpUa2xVU1VGTVgxQlBVRlZNUVZSSlQwNEtLRkJoZEdsbGJuUXVaMlZ1WkdWeUlEMGdKMjFoYkdVbktTQmhibVFLS0Nnb1pYaHBjM1J6VzBOdmJtUnBkR2x2YmpvZ1EyOWtaU0FuUXpZeEp5Qm1jbTl0SUdsalpERXdYU2tnYjNJZ0tHVjRhWE4wYzF0RGIyNWthWFJwYjI0NklFTnZaR1VnSjBNMk1TY2dabkp2YlNCcFkyUXhNR2R0WFNrcElHOXlJQ2hsZUdsemRITWdabkp2YlNCYlUzQmxZMmx0Wlc1ZElGTWdkMmhsY21VZ0tGTXVaWGgwWlc1emFXOXVMbmRvWlhKbEtIVnliRDBuYUhSMGNITTZMeTltYUdseUxtSmliWEpwTG1SbEwxTjBjblZqZEhWeVpVUmxabWx1YVhScGIyNHZVMkZ0Y0d4bFJHbGhaMjV2YzJsekp5a3VkbUZzZFdVdVkyOWthVzVuTG1OdlpHVWdZMjl1ZEdGcGJuTWdKME0yTVNjcEtTa2dZVzVrQ2lnb1pYaHBjM1J6SUZ0VGNHVmphVzFsYmpvZ1EyOWtaU0FuWW14dmIyUXRjMlZ5ZFcwbklHWnliMjBnVTJGdGNHeGxUV0YwWlhKcFlXeFVlWEJsWFNrZ2IzSUtLR1Y0YVhOMGN5QmJVM0JsWTJsdFpXNDZJRU52WkdVZ0ozUnBjM04xWlMxbWNtOTZaVzRuSUdaeWIyMGdVMkZ0Y0d4bFRXRjBaWEpwWVd4VWVYQmxYU2tnYjNJS0tHVjRhWE4wY3lCYlUzQmxZMmx0Wlc0NklFTnZaR1VnSjNkb2IyeGxMV0pzYjI5a0p5Qm1jbTl0SUZOaGJYQnNaVTFoZEdWeWFXRnNWSGx3WlYwcElHOXlDaWhsZUdsemRITWdXMU53WldOcGJXVnVPaUJEYjJSbElDZGliRzl2WkMxd2JHRnpiV0VuSUdaeWIyMGdVMkZ0Y0d4bFRXRjBaWEpwWVd4VWVYQmxYU2tnYjNJS0tHVjRhWE4wY3lCYlUzQmxZMmx0Wlc0NklFTnZaR1VnSjNScGMzTjFaUzF2ZEdobGNpY2dabkp2YlNCVFlXMXdiR1ZOWVhSbGNtbGhiRlI1Y0dWZEtTQnZjZ29vWlhocGMzUnpJRnRUY0dWamFXMWxiam9nUTI5a1pTQW5jR1Z5YVhCb1pYSmhiQzFpYkc5dlpDMWpaV3hzY3kxMmFYUmhiQ2NnWm5KdmJTQlRZVzF3YkdWTllYUmxjbWxoYkZSNWNHVmRLU0J2Y2dvb1pYaHBjM1J6SUZ0VGNHVmphVzFsYmpvZ1EyOWtaU0FuY201aEp5Qm1jbTl0SUZOaGJYQnNaVTFoZEdWeWFXRnNWSGx3WlYwcElHOXlDaWhsZUdsemRITWdXMU53WldOcGJXVnVPaUJEYjJSbElDZDFjbWx1WlNjZ1puSnZiU0JUWVcxd2JHVk5ZWFJsY21saGJGUjVjR1ZkS1NCdmNnb29aWGhwYzNSeklGdFRjR1ZqYVcxbGJqb2dRMjlrWlNBbmJHbHhkV2xrTFc5MGFHVnlKeUJtY205dElGTmhiWEJzWlUxaGRHVnlhV0ZzVkhsd1pWMHBJRzl5Q2lobGVHbHpkSE1nVzFOd1pXTnBiV1Z1T2lCRGIyUmxJQ2RpZFdabWVTMWpiMkYwSnlCbWNtOXRJRk5oYlhCc1pVMWhkR1Z5YVdGc1ZIbHdaVjBwSUc5eUNpaGxlR2x6ZEhNZ1cxTndaV05wYldWdU9pQkRiMlJsSUNka2JtRW5JR1p5YjIwZ1UyRnRjR3hsVFdGMFpYSnBZV3hVZVhCbFhTa2diM0lLS0dWNGFYTjBjeUJiVTNCbFkybHRaVzQ2SUVOdlpHVWdKMkp2Ym1VdGJXRnljbTkzSnlCbWNtOXRJRk5oYlhCc1pVMWhkR1Z5YVdGc1ZIbHdaVjBwSUc5eUNpaGxlR2x6ZEhNZ1cxTndaV05wYldWdU9pQkRiMlJsSUNkMGFYTnpkV1V0Wm1ad1pTY2dabkp2YlNCVFlXMXdiR1ZOWVhSbGNtbGhiRlI1Y0dWZEtTQnZjZ29vWlhocGMzUnpJRnRUY0dWamFXMWxiam9nUTI5a1pTQW5jMkZzYVhaaEp5Qm1jbTl0SUZOaGJYQnNaVTFoZEdWeWFXRnNWSGx3WlYwcElHOXlDaWhsZUdsemRITWdXMU53WldOcGJXVnVPaUJEYjJSbElDZGtjbWxsWkMxM2FHOXNaUzFpYkc5dlpDY2dabkp2YlNCVFlXMXdiR1ZOWVhSbGNtbGhiRlI1Y0dWZEtTQnZjZ29vWlhocGMzUnpJRnRUY0dWamFXMWxiam9nUTI5a1pTQW5jR3hoYzIxaExXVmtkR0VuSUdaeWIyMGdVMkZ0Y0d4bFRXRjBaWEpwWVd4VWVYQmxYU2tnYjNJS0tHVjRhWE4wY3lCYlUzQmxZMmx0Wlc0NklFTnZaR1VnSjNCc1lYTnRZUzFqYVhSeVlYUW5JR1p5YjIwZ1UyRnRjR3hsVFdGMFpYSnBZV3hVZVhCbFhTa2diM0lLS0dWNGFYTjBjeUJiVTNCbFkybHRaVzQ2SUVOdlpHVWdKM0JzWVhOdFlTMW9aWEJoY21sdUp5Qm1jbTl0SUZOaGJYQnNaVTFoZEdWeWFXRnNWSGx3WlYwcElHOXlDaWhsZUdsemRITWdXMU53WldOcGJXVnVPaUJEYjJSbElDZHdiR0Z6YldFdFkyVnNiQzFtY21WbEp5Qm1jbTl0SUZOaGJYQnNaVTFoZEdWeWFXRnNWSGx3WlYwcElHOXlDaWhsZUdsemRITWdXMU53WldOcGJXVnVPaUJEYjJSbElDZHdiR0Z6YldFdGIzUm9aWEluSUdaeWIyMGdVMkZ0Y0d4bFRXRjBaWEpwWVd4VWVYQmxYU2tnYjNJS0tHVjRhWE4wY3lCYlUzQmxZMmx0Wlc0NklFTnZaR1VnSjNCc1lYTnRZU2NnWm5KdmJTQlRZVzF3YkdWTllYUmxjbWxoYkZSNWNHVmRLU0J2Y2dvb1pYaHBjM1J6SUZ0VGNHVmphVzFsYmpvZ1EyOWtaU0FuYzJWeWRXMG5JR1p5YjIwZ1UyRnRjR3hsVFdGMFpYSnBZV3hVZVhCbFhTa2diM0lLS0dWNGFYTjBjeUJiVTNCbFkybHRaVzQ2SUVOdlpHVWdKM1IxYlc5eUxYUnBjM04xWlMxbVpuQmxKeUJtY205dElGTmhiWEJzWlUxaGRHVnlhV0ZzVkhsd1pWMHBJRzl5Q2lobGVHbHpkSE1nVzFOd1pXTnBiV1Z1T2lCRGIyUmxJQ2R1YjNKdFlXd3RkR2x6YzNWbExXWm1jR1VuSUdaeWIyMGdVMkZ0Y0d4bFRXRjBaWEpwWVd4VWVYQmxYU2tnYjNJS0tHVjRhWE4wY3lCYlUzQmxZMmx0Wlc0NklFTnZaR1VnSjI5MGFHVnlMWFJwYzNOMVpTMW1abkJsSnlCbWNtOXRJRk5oYlhCc1pVMWhkR1Z5YVdGc1ZIbHdaVjBwSUc5eUNpaGxlR2x6ZEhNZ1cxTndaV05wYldWdU9pQkRiMlJsSUNkMGFYTnpkV1V0Wm05eWJXRnNhVzRuSUdaeWIyMGdVMkZ0Y0d4bFRXRjBaWEpwWVd4VWVYQmxYU2tnYjNJS0tHVjRhWE4wY3lCYlUzQmxZMmx0Wlc0NklFTnZaR1VnSjNSMWJXOXlMWFJwYzNOMVpTMW1jbTk2Wlc0bklHWnliMjBnVTJGdGNHeGxUV0YwWlhKcFlXeFVlWEJsWFNrZ2IzSUtLR1Y0YVhOMGN5QmJVM0JsWTJsdFpXNDZJRU52WkdVZ0oyNXZjbTFoYkMxMGFYTnpkV1V0Wm5KdmVtVnVKeUJtY205dElGTmhiWEJzWlUxaGRHVnlhV0ZzVkhsd1pWMHBJRzl5Q2lobGVHbHpkSE1nVzFOd1pXTnBiV1Z1T2lCRGIyUmxJQ2R2ZEdobGNpMTBhWE56ZFdVdFpuSnZlbVZ1SnlCbWNtOXRJRk5oYlhCc1pVMWhkR1Z5YVdGc1ZIbHdaVjBwSUc5eUNpaGxlR2x6ZEhNZ1cxTndaV05wYldWdU9pQkRiMlJsSUNkalppMWtibUVuSUdaeWIyMGdVMkZ0Y0d4bFRXRjBaWEpwWVd4VWVYQmxYU2tnYjNJS0tHVjRhWE4wY3lCYlUzQmxZMmx0Wlc0NklFTnZaR1VnSjJjdFpHNWhKeUJtY205dElGTmhiWEJzWlUxaGRHVnlhV0ZzVkhsd1pWMHBJRzl5Q2lobGVHbHpkSE1nVzFOd1pXTnBiV1Z1T2lCRGIyUmxJQ2QwYVhOemRXVXRjR0Y0WjJWdVpTMXZjaTFsYkhObEp5Qm1jbTl0SUZOaGJYQnNaVTFoZEdWeWFXRnNWSGx3WlYwcElHOXlDaWhsZUdsemRITWdXMU53WldOcGJXVnVPaUJEYjJSbElDZDBhWE56ZFdVbklHWnliMjBnVTJGdGNHeGxUV0YwWlhKcFlXeFVlWEJsWFNrZ2IzSUtLR1Y0YVhOMGN5QmJVM0JsWTJsdFpXNDZJRU52WkdVZ0oyeHBjWFZwWkNjZ1puSnZiU0JUWVcxd2JHVk5ZWFJsY21saGJGUjVjR1ZkS1NrPSIKCQkJfQoJCV0sCgkJInJlc291cmNlVHlwZSI6ICJMaWJyYXJ5IiwKCQkic3RhdHVzIjogImFjdGl2ZSIsCgkJInR5cGUiOiB7CgkJCSJjb2RpbmciOiBbCgkJCQl7CgkJCQkJImNvZGUiOiAibG9naWMtbGlicmFyeSIsCgkJCQkJInN5c3RlbSI6ICJodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2xpYnJhcnktdHlwZSIKCQkJCX0KCQkJXQoJCX0sCgkJInVybCI6ICJ1cm46dXVpZDpiMDQ2NzJmMC1mZTQ4LTQwNzMtOWQ3OC1jNWQyNDgyNTJhNTUiCgl9LAoJIm1lYXN1cmUiOiB7CgkJImdyb3VwIjogWwoJCQl7CgkJCQkiY29kZSI6IHsKCQkJCQkidGV4dCI6ICJwYXRpZW50cyIKCQkJCX0sCgkJCQkicG9wdWxhdGlvbiI6IFsKCQkJCQl7CgkJCQkJCSJjb2RlIjogewoJCQkJCQkJImNvZGluZyI6IFsKCQkJCQkJCQl7CgkJCQkJCQkJCSJjb2RlIjogImluaXRpYWwtcG9wdWxhdGlvbiIsCgkJCQkJCQkJCSJzeXN0ZW0iOiAiaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9tZWFzdXJlLXBvcHVsYXRpb24iCgkJCQkJCQkJfQoJCQkJCQkJXQoJCQkJCQl9LAoJCQkJCQkiY3JpdGVyaWEiOiB7CgkJCQkJCQkiZXhwcmVzc2lvbiI6ICJJbkluaXRpYWxQb3B1bGF0aW9uIiwKCQkJCQkJCSJsYW5ndWFnZSI6ICJ0ZXh0L2NxbC1pZGVudGlmaWVyIgoJCQkJCQl9CgkJCQkJfQoJCQkJXSwKCQkJCSJzdHJhdGlmaWVyIjogWwoJCQkJCXsKCQkJCQkJImNvZGUiOiB7CgkJCQkJCQkidGV4dCI6ICJHZW5kZXIiCgkJCQkJCX0sCgkJCQkJCSJjcml0ZXJpYSI6IHsKCQkJCQkJCSJleHByZXNzaW9uIjogIkdlbmRlciIsCgkJCQkJCQkibGFuZ3VhZ2UiOiAidGV4dC9jcWwiCgkJCQkJCX0KCQkJCQl9LAoJCQkJCXsKCQkJCQkJImNvZGUiOiB7CgkJCQkJCQkidGV4dCI6ICJBZ2UiCgkJCQkJCX0sCgkJCQkJCSJjcml0ZXJpYSI6IHsKCQkJCQkJCSJleHByZXNzaW9uIjogIkFnZUNsYXNzIiwKCQkJCQkJCSJsYW5ndWFnZSI6ICJ0ZXh0L2NxbCIKCQkJCQkJfQoJCQkJCX0sCgkJCQkJewoJCQkJCQkiY29kZSI6IHsKCQkJCQkJCSJ0ZXh0IjogIkN1c3RvZGlhbiIKCQkJCQkJfSwKCQkJCQkJImNyaXRlcmlhIjogewoJCQkJCQkJImV4cHJlc3Npb24iOiAiQ3VzdG9kaWFuIiwKCQkJCQkJCSJsYW5ndWFnZSI6ICJ0ZXh0L2NxbCIKCQkJCQkJfQoJCQkJCX0KCQkJCV0KCQkJfSwKCQkJewoJCQkJImNvZGUiOiB7CgkJCQkJInRleHQiOiAiZGlhZ25vc2lzIgoJCQkJfSwKCQkJCSJleHRlbnNpb24iOiBbCgkJCQkJewoJCQkJCQkidXJsIjogImh0dHA6Ly9obDcub3JnL2ZoaXIvdXMvY3FmbWVhc3VyZXMvU3RydWN0dXJlRGVmaW5pdGlvbi9jcWZtLXBvcHVsYXRpb25CYXNpcyIsCgkJCQkJCSJ2YWx1ZUNvZGUiOiAiQ29uZGl0aW9uIgoJCQkJCX0KCQkJCV0sCgkJCQkicG9wdWxhdGlvbiI6IFsKCQkJCQl7CgkJCQkJCSJjb2RlIjogewoJCQkJCQkJImNvZGluZyI6IFsKCQkJCQkJCQl7CgkJCQkJCQkJCSJjb2RlIjogImluaXRpYWwtcG9wdWxhdGlvbiIsCgkJCQkJCQkJCSJzeXN0ZW0iOiAiaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9tZWFzdXJlLXBvcHVsYXRpb24iCgkJCQkJCQkJfQoJCQkJCQkJXQoJCQkJCQl9LAoJCQkJCQkiY3JpdGVyaWEiOiB7CgkJCQkJCQkiZXhwcmVzc2lvbiI6ICJEaWFnbm9zaXMiLAoJCQkJCQkJImxhbmd1YWdlIjogInRleHQvY3FsLWlkZW50aWZpZXIiCgkJCQkJCX0KCQkJCQl9CgkJCQldLAoJCQkJInN0cmF0aWZpZXIiOiBbCgkJCQkJewoJCQkJCQkiY29kZSI6IHsKCQkJCQkJCSJ0ZXh0IjogImRpYWdub3NpcyIKCQkJCQkJfSwKCQkJCQkJImNyaXRlcmlhIjogewoJCQkJCQkJImV4cHJlc3Npb24iOiAiRGlhZ25vc2lzQ29kZSIsCgkJCQkJCQkibGFuZ3VhZ2UiOiAidGV4dC9jcWwtaWRlbnRpZmllciIKCQkJCQkJfQoJCQkJCX0KCQkJCV0KCQkJfSwKCQkJewoJCQkJImNvZGUiOiB7CgkJCQkJInRleHQiOiAic3BlY2ltZW4iCgkJCQl9LAoJCQkJImV4dGVuc2lvbiI6IFsKCQkJCQl7CgkJCQkJCSJ1cmwiOiAiaHR0cDovL2hsNy5vcmcvZmhpci91cy9jcWZtZWFzdXJlcy9TdHJ1Y3R1cmVEZWZpbml0aW9uL2NxZm0tcG9wdWxhdGlvbkJhc2lzIiwKCQkJCQkJInZhbHVlQ29kZSI6ICJTcGVjaW1lbiIKCQkJCQl9CgkJCQldLAoJCQkJInBvcHVsYXRpb24iOiBbCgkJCQkJewoJCQkJCQkiY29kZSI6IHsKCQkJCQkJCSJjb2RpbmciOiBbCgkJCQkJCQkJewoJCQkJCQkJCQkiY29kZSI6ICJpbml0aWFsLXBvcHVsYXRpb24iLAoJCQkJCQkJCQkic3lzdGVtIjogImh0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vbWVhc3VyZS1wb3B1bGF0aW9uIgoJCQkJCQkJCX0KCQkJCQkJCV0KCQkJCQkJfSwKCQkJCQkJImNyaXRlcmlhIjogewoJCQkJCQkJImV4cHJlc3Npb24iOiAiU3BlY2ltZW4iLAoJCQkJCQkJImxhbmd1YWdlIjogInRleHQvY3FsLWlkZW50aWZpZXIiCgkJCQkJCX0KCQkJCQl9CgkJCQldLAoJCQkJInN0cmF0aWZpZXIiOiBbCgkJCQkJewoJCQkJCQkiY29kZSI6IHsKCQkJCQkJCSJ0ZXh0IjogInNhbXBsZV9raW5kIgoJCQkJCQl9LAoJCQkJCQkiY3JpdGVyaWEiOiB7CgkJCQkJCQkiZXhwcmVzc2lvbiI6ICJTYW1wbGVUeXBlIiwKCQkJCQkJCSJsYW5ndWFnZSI6ICJ0ZXh0L2NxbCIKCQkJCQkJfQoJCQkJCX0KCQkJCV0KCQkJfQoJCV0sCgkJImxpYnJhcnkiOiAidXJuOnV1aWQ6YjA0NjcyZjAtZmU0OC00MDczLTlkNzgtYzVkMjQ4MjUyYTU1IiwKCQkicmVzb3VyY2VUeXBlIjogIk1lYXN1cmUiLAoJCSJzY29yaW5nIjogewoJCQkiY29kaW5nIjogWwoJCQkJewoJCQkJCSJjb2RlIjogImNvaG9ydCIsCgkJCQkJInN5c3RlbSI6ICJodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL21lYXN1cmUtc2NvcmluZyIKCQkJCX0KCQkJXQoJCX0sCgkJInN0YXR1cyI6ICJhY3RpdmUiLAoJCSJzdWJqZWN0Q29kZWFibGVDb25jZXB0IjogewoJCQkiY29kaW5nIjogWwoJCQkJewoJCQkJCSJjb2RlIjogIlBhdGllbnQiLAoJCQkJCSJzeXN0ZW0iOiAiaHR0cDovL2hsNy5vcmcvZmhpci9yZXNvdXJjZS10eXBlcyIKCQkJCX0KCQkJXQoJCX0sCgkJInVybCI6ICJ1cm46dXVpZDo0OGJjOWY4Ny1iMWJiLTRjZjYtYmIzNy05N2ViOGVhMTgyNTYiCgl9Cn0="}' -H "Authorization: ApiKey app1.proxy1.broker App1Secret" http://localhost:8081/v1/tasks
```

## License

This code is licensed under the Apache License 2.0. For details, please see [LICENSE](./LICENSE)
